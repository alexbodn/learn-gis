<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		
		<link href="./lib/leaflet.css" rel="stylesheet" />
		<script src="./lib/proj4.js"></script>
		<script src="./lib/leaflet-src.js"></script>
		<script src="./lib/leaflet.textpath.js"></script>
		<script src="./lib/leaflet.sld.js"></script>
		<script src="./lib/proj4leaflet.js"></script>
		<link href="./lib/leaflet.zoomdisplay.css" rel="stylesheet" />
		<script src="./lib/leaflet.zoomdisplay-src.js"></script>
		<!--
		-->
		
		<!--
		<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/ol@v8.2.0/ol.css" />
		<link rel="stylesheet" href="https://unpkg.com/ol-layerswitcher@4.1.1/dist/ol-layerswitcher.css" />
		<link rel="stylesheet" href="./lib/ol.css" />
		<link rel="stylesheet" href="./lib/ol-layerswitcher.css" />
		-->
		
		<!--
		<script src="./lib/lib.js"></script>
		-->
		<!--
		<script type="text/javascript" src="./lib/ol.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/ol@v8.2.0/dist/ol.js"></script>
		-->
		<!--
		<script src="https://unpkg.com/ol-layerswitcher@4.1.1/dist/ol-layerswitcher.js"></script>
		-->
		
		<!--
		<script type="text/javascript" src="./lib/ol-layerswitcher.js"></script>
		<script type="text/javascript" src="./sld/sldreader.js"></script>
		-->
		
		<style>
			body {
				/*margin: 0px;*/
			}
			.map {
				width: 98vw;
				height: 60vh;
				border: solid 1px gray;
				/*position: fixed;*/
			}
		</style>
		<title>
			Import a GeoPackage
		</title>
	</head>
	<body>
		<div id="map" class="map"></div>
		<!--div id="explanation">OpenLayers displaying a .osm file directly. This <a href="display-osm.osm">display-osm.osm</a> is a very small example. Most .osm files would be too large to do this, and in general you're more likely to load in vector features in a different way</div-->
		<div id="sqlQuery"></div>
		
		<script src="./lib/sqlquery.js"></script>
		<script src="./lib/map_show3.js"></script>

<!--
<script src="./stlouis.js"></script>
-->
<script src="./london_boroughs.js"></script>

		<script>


const natural_earth_local = new URL('./test/files/dbs/Natural_Earth_QGIS_layers_and_styles.gpkg', window.location.href).toString();
const dctour_remote = 'https://github.com/ngageoint/geopackage-js/raw/master/docs/examples/GoingOfflineWithGeoPackage/public/DCTour.gpkg';
const dctour_local = new URL('./test/files/dbs/dctour.gpkg', window.location.href).toString();
const rivers_remote = 'https://www.geopackage.org/data/rivers.gpkg';
const rivers_local = new URL('./test/files/dbs/rivers.gpkg', window.location.href).toString();

//autoGeoJSON = false;

const dbMount = 'data';

// Map View Projection
let displayProjection = {
	srs_id: 3857,
	srs_code: 'EPSG:3857',
};

// mountpoint has to be unique.
// but the array is used, to fetch files without mounting
/*
const userData = [
	{mountpoint: dbMount, filename: 'StLouis.gpkg', url, method: 'arrayBuffer'},
];
*/

async function onMounted(db, fetched, {baseLayers, overLayers}) {

	let map = build_map('map');
	/**/
	if (!baseLayers.length) {
		let osm = L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
			maxZoom: 19,
			attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
		});
	map.addLayer(osm);
	}
	else {
		let bwStamen = L.tileLayer('https://tiles.stadiamaps.com/tiles/stamen_toner/{z}/{x}/{y}.png', {
			maxZoom: 16,
			attribution: `
				&copy; <a href="https://stadiamaps.com/" target="_blank">Stadia Maps</a>
				&copy; <a href="https://openmaptiles.org/" target="_blank">OpenMapTiles</a>
				&copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a>
			`
		});
		map.addLayer(bwStamen);
	}
	/**/
	let maxBounds;
	let tileLayer;
	for (let layer of baseLayers) {
	//console.log(layer);
		tileLayer = layer;
		map.addLayer(layer);
		layer.bringToFront();
		//maxBounds = layer.options.bounds;
	}
	for (let layer of overLayers) {
	//console.log(layer);
		map.addLayer(layer);
	}
	
	if (typeof 'viewOptions' === 'undefined') {
		var viewOptions = null;
	}
	show_map(map, viewOptions);
	
	new SQLQuery('div#sqlQuery', db, map);
}

		</script>
		
		<script src="./lib/jszip.min.js" type="text/javascript"></script>
		<script src="./lib/filesaver.js" type="text/javascript"></script>
		<!--script src="./lib/eruda.js" type="text/javascript"></script-->
		<script type="module" src="./lib/spl-view3.js"></script>
		<script>
		/*
		create temp table if not exists t(a,b,c);
		create temp trigger if not exists 
		before insert on temp.t
		--for each row 
		begin
		select raise (abort, 'message');
		end;
		insert into temp.t(a) values(123);
		*/
		</script>
	</body>
</html>
