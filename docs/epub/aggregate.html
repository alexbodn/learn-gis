<?xml version='1.0' encoding='utf-8'?>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta name="generator" content="&lt;/p"/>
    <title>Unknown</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  <link rel="stylesheet" type="text/css" href="stylesheet.css"/>
<link rel="stylesheet" type="text/css" href="page_styles.css"/>
</head>
  <body class="calibre"><p class="calibre1">"HTML Tidy for HTML5 for Linux version 5.6.0" /&gt;
</p>
<p class="calibre1"><title class="calibre2">SpatiaLite Cookbook</title>


<table width="100%" cellpadding="4" cellspacing="0" class="calibre3">
<tbody class="calibre4"><tr class="calibre5">
<td class="calibre13"><img src="spatialite.png" alt="SpatiaLite logo" class="calibre14"/></td>
<td class="calibre13">
<p class="calibre7"><span class="calibre15">
</span></p><p class="calibre1"><span class="calibre15">"font-size: 32pt"&gt;<b class="calibre9">Understanding aggregate</b></span></p><span class="calibre15"><b class="calibre9">
</b></span><p class="calibre1"><span class="calibre15"><b class="calibre9">functions</b></span></p>
<p class="calibre1"></p>
<p class="calibre1"></p></td>
</tr>
<tr class="calibre5">
<td class="calibre13"><i class="calibre11">2011 January 28</i></td>
</tr>
</tbody></table>
<br class="calibre12"/>
<table width="100%" cellpadding="8" cellspacing="8" class="calibre3">
<tbody class="calibre4"><tr class="calibre5">
<td width="33%" class="calibre26"><a href="&lt;/p">
</a><p class="calibre1"><a href="&lt;/p">"basic-sql.html"&gt;Previous Slide</a></p></td>
<td class="calibre27"><a href="&lt;/p">
</a><p class="calibre1"><a href="&lt;/p">"../index.html#toc"&gt;Table of Contents</a></p></td>
<td class="calibre28"><a href="&lt;/p">
</a><p class="calibre1"><a href="&lt;/p">"first-spatial.html"&gt;Next Slide</a></p></td>
</tr>
</tbody></table>
<br class="calibre12"/>
We've seen since now how SQL allows to retrieve single values on a</p>
<p class="calibre1">row-per-row basis.<br class="calibre12"/>
A different approach is supported as well, one allowing to compute</p>
<p class="calibre1"><i class="calibre11"><b class="calibre9">total values</b></i> for the whole table, or for group(s) of</p>
<p class="calibre1">selected rows.<br class="calibre12"/>
This implies using some special functions, known as <b class="calibre9">aggregate</b></p><b class="calibre9">
</b><p class="calibre1"><b class="calibre9">functions</b>.</p>
<p class="calibre1"></p><hr class="calibre23"/>
<p class="calibre12" style="margin:0pt; border:0pt; height:1em"> </p>
<table border="1" cellpadding="4" cellspacing="0" class="calibre3">
<tbody class="calibre4"><tr class="calibre5">
<td class="calibre40"><div class="calibre33"><b class="calibre9">SELECT<p class="calibre1"></p>
</b></div><p class="calibre1"><span class="calibre33"><b class="calibre9">Min(POP2001), Max(POP2001),</b><br class="calibre12"/>
<b class="calibre9">  Avg(POP2001), Sum(POP2001), Count(*)</b><br class="calibre12"/>
<b class="calibre9">FROM com2001_s;</b></span></p></td>
</tr>
</tbody></table>
This query will return a single row, representing something like a<p class="calibre1"></p>
<p class="calibre1">summary for the whole table:</p>
<p class="calibre1"></p><ul class="calibre21">
<li class="calibre22">the <span class="calibre33"><b class="calibre9">Min()</b></span>
function will return the minimum value found into the given<p class="calibre1"></p>
<p class="calibre1">column</p></li>
<li class="calibre22">the <span class="calibre33"><b class="calibre9">Max()</b></span>
function will return the maximum value found into the given<p class="calibre1"></p>
<p class="calibre1">column</p></li>
<li class="calibre22">the <span class="calibre33"><b class="calibre9">Avg()</b></span>
function will return the average value for the given column</li>
<li class="calibre22">the <span class="calibre33"><b class="calibre9">Sum()</b></span>
function will return the total corresponding to the given<p class="calibre1"></p>
<p class="calibre1">column</p></li>
<li class="calibre22">the <span class="calibre33"><b class="calibre9">Count()</b></span>
function will return the number of rows (entities) found</li>
</ul>
<table border="1" cellpadding="4" cellspacing="0" class="calibre3">
<tbody class="calibre4"><tr class="calibre5">
<td class="calibre40"><div class="calibre33"><b class="calibre9">SELECT<p class="calibre1"></p>
</b></div><p class="calibre1"><span class="calibre33"><b class="calibre9">COD_PRO, Min(POP2001), Max(POP2001),</b><br class="calibre12"/>
<b class="calibre9">  Avg(POP2001), Sum(POP2001), Count(*)</b><br class="calibre12"/>
<b class="calibre9">FROM com2001_s</b><br class="calibre12"/>
<b class="calibre9">GROUP BY COD_PRO;</b><br class="calibre12"/></span></p></td>
</tr>
</tbody></table>
You can use the <div class="calibre33"><b class="calibre9">GROUP<p class="calibre1"></p>
</b></div><p class="calibre1"><span class="calibre33"><b class="calibre9">BY</b></span> clause in order to establish a more finely grained</p>
<p class="calibre1">aggregation by sub-groups.<br class="calibre12"/>
This query will return distinct totals for each County.<br class="calibre12"/>
<br class="calibre12"/>
<table border="1" cellpadding="4" cellspacing="0" class="calibre3">
<tbody class="calibre4"><tr class="calibre5">
<td class="calibre40"><div class="calibre33"><b class="calibre9">SELECT<p class="calibre1"></p>
</b></div><p class="calibre1"><span class="calibre33"><b class="calibre9">COD_REG, Min(POP2001), Max(POP2001),</b><br class="calibre12"/>
<b class="calibre9">  Avg(POP2001), Sum(POP2001), Count(*)</b><br class="calibre12"/>
<b class="calibre9">FROM com2001_s</b><br class="calibre12"/>
<b class="calibre9">GROUP BY COD_REG;</b><br class="calibre12"/></span></p></td>
</tr>
</tbody></table>
And you can obviously get totals for each Region simply changing</p>
<p class="calibre1">the <span class="calibre33"><b class="calibre9">GROUP BY</b></span>
criterion.</p>
<p class="calibre1"></p><hr class="calibre23"/>
<p class="calibre12" style="margin:0pt; border:0pt; height:1em"> </p>
<table border="1" cellpadding="4" cellspacing="0" class="calibre3">
<tbody class="calibre4"><tr class="calibre5">
<td class="calibre40"><div class="calibre33"><b class="calibre9">SELECT<p class="calibre1"></p>
</b></div><p class="calibre1"><span class="calibre33"><b class="calibre9">DISTINCT COD_REG, COD_PRO</b><br class="calibre12"/>
<b class="calibre9">FROM com2001_s</b><br class="calibre12"/>
<b class="calibre9">ORDER BY COD_REG, COD_PRO;</b><br class="calibre12"/></span></p></td>
</tr>
</tbody></table>
There is another different way to aggregate rows: i.e. using the<p class="calibre1"></p>
<p class="calibre1"><span class="calibre33"><b class="calibre9">DISTINCT</b></span>
clause.<br class="calibre12"/>
<span class="calibre17">Please note well:</span> this isn't absolutely the same as using a</p>
<p class="calibre1"><span class="calibre33"><b class="calibre9">GROUP BY</b></span> clause:</p>
<p class="calibre1"></p><ul class="calibre21">
<li class="calibre22"><span class="calibre33"><b class="calibre9">DISTINCT</b></span>
simply suppresses any duplicate row, but has nothing to do with<p class="calibre1"></p>
<p class="calibre1">aggregate functions.</p></li>
<li class="calibre22"><span class="calibre33"><b class="calibre9">GROUP BY</b></span> is<p class="calibre1"></p>
<p class="calibre1">absolutely required each time you have to properly control</p>
<p class="calibre1">aggregation.</p></li>
</ul>
<table width="100%" cellpadding="8" cellspacing="8" class="calibre3">
<tbody class="calibre4"><tr class="calibre5">
<td width="33%" class="calibre26"><a href="&lt;/p">
</a><p class="calibre1"><a href="&lt;/p">"basic-sql.html"&gt;Previous Slide</a></p></td>
<td class="calibre27"><a href="&lt;/p">
</a><p class="calibre1"><a href="&lt;/p">"../index.html#toc"&gt;Table of Contents</a></p></td>
<td class="calibre28"><a href="&lt;/p">
</a><p class="calibre1"><a href="&lt;/p">"first-spatial.html"&gt;Next Slide</a></p></td>
</tr>
</tbody></table>
<p class="calibre12" style="margin:0pt; border:0pt; height:1em"> </p>
<table class="calibre3">
<tbody class="calibre4"><tr class="calibre5">
<td rowspan="2" class="calibre13"><img src="cc-by-sa.png" alt="&lt;/p" class="calibre14"/>
<p class="calibre1">"CC-BY-SA logo" /&gt;</p></td>
<td class="calibre13"><b class="calibre9">Author:</b> Alessandro Furieri <a href="&lt;/p">
</a><p class="calibre1"><a href="&lt;/p">"mailto:a.furieri@lqt.it"&gt;a.furieri@lqt.it</a></p></td>
</tr>
<tr class="calibre5">
<td class="calibre13">This work is licensed under the <a href="&lt;/p">
<p class="calibre1">"http://creativecommons.org/licenses/by-sa/3.0/"&gt;Attribution-ShareAlike</p>
</a><p class="calibre1"><a href="&lt;/p">3.0 Unported (CC BY-SA 3.0)</a> license.</p></td>
</tr>
<tr class="calibre5">
<td colspan="2" class="calibre13">
<hr class="calibre23"/></td>
</tr>
<tr class="calibre5">
<td class="calibre13"><img src="gnu.png" alt="GNU logo" class="calibre14"/></td>
<td class="calibre13">Permission is granted to copy, distribute and/or modify this<p class="calibre1"></p>
<p class="calibre1">document under the terms of the<br class="calibre12"/>
<a href="http://www.gnu.org/licenses/fdl.html">GNU Free</a></p><a href="http://www.gnu.org/licenses/fdl.html">
</a><p class="calibre1"><a href="http://www.gnu.org/licenses/fdl.html">Documentation License</a>, Version 1.3 or any later version</p>
<p class="calibre1">published by the Free Software Foundation;<br class="calibre12"/>
with no Invariant Sections, no Front-Cover Texts, and no Back-Cover</p>
<p class="calibre1">Texts.</p></td>
</tr>
</tbody></table>


</body></html>
